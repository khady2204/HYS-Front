import{a as B}from"./chunk-NH4GJBFC.js";import{a as $}from"./chunk-YDNSLJXR.js";import{k as q}from"./chunk-YVFP7G2U.js";import"./chunk-POA22WFE.js";import"./chunk-QUJFQN2Y.js";import"./chunk-6D27DZ34.js";import"./chunk-3NODV7JW.js";import"./chunk-547OZNO4.js";import"./chunk-JX6BS7SJ.js";import"./chunk-3TIPS6QV.js";import"./chunk-BSAYALUA.js";import"./chunk-7FY2OE2O.js";import"./chunk-J2OL6VUA.js";import"./chunk-GSIDHORN.js";import"./chunk-ET25664Q.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-JWWC77AT.js";import"./chunk-CKP3SGE2.js";import"./chunk-5IOERQT4.js";import{g as U}from"./chunk-SKEETBT7.js";import{a as A}from"./chunk-NUWLO4TS.js";import"./chunk-RETT3Y54.js";import{Ac as V,Bc as j,Da as P,Ha as E,Ub as C,Va as b,W as x,Wa as o,X as S,Xa as r,Xb as I,Ya as n,cc as F,fb as _,gb as f,ib as g,jc as y,lc as a,nc as k,oc as N,qb as l,rb as w,rc as M,sa as u,sc as O,tc as D,xa as m,zc as T}from"./chunk-WVCMXTPH.js";import"./chunk-AAGPOIMH.js";import"./chunk-HFL6MWQG.js";import"./chunk-UJWRXINH.js";import"./chunk-4XRDT473.js";import"./chunk-OAZACCPN.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-HHPFJLTL.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as v}from"./chunk-JHI3MBHO.js";function L(d,s){if(d&1){let h=_();o(0,"div",34)(1,"div",35)(2,"input",36),f("change",function(t){x(h);let i=g();return S(i.onCheckboxChange(t))}),r(),o(3,"label",37),l(4),r()()()}if(d&2){let h,e=s.$implicit,t=g();u(2),b("value",e.id)("checked",(h=t.editProfileForm.get("interets"))==null?null:h.value.includes(e.id)),u(2),w(e.nom)}}var ee=(()=>{let s=class s{constructor(e,t,i,c,p,G){this.location=e,this.fb=t,this.userService=i,this.authUserService=c,this.toastController=p,this.interetService=G,this.profileImagePreview=null,this.interets=[],this.userInterets=[]}ngOnInit(){this.editProfileForm=this.fb.group({nom:["",a.required],prenom:["",a.required],email:["",[a.required,a.email]],phone:["",[a.required,a.pattern("^[0-9 +()-]{9,20}$")]],adresse:["",a.required],bio:["",a.required],dob:["",a.required],interets:["",a.required]});let e=this.authUserService.getUser();e&&e.id?(this.userId=e.id,this.editProfileForm.patchValue({prenom:e.prenom??"",nom:e.nom??"",email:e.email??"",phone:e.phone??"",adresse:e.adresse??"",bio:e.bio??"",dob:this.convertToDateInputFormat(e.dateNaissance)})):console.error("Utilisateur non trouv\xE9 dans le localStorage"),this.loadInterets(),this.loadUserInterets()}convertToDateInputFormat(e){if(!e)return"";let t=new Date(e),i=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),p=String(t.getDate()).padStart(2,"0");return`${i}-${c}-${p}`}onSubmit(){if(this.editProfileForm.valid){console.log("Formulaire envoy\xE9 avec les valeurs :",this.editProfileForm.value);let e=this.editProfileForm.value,t={id:this.userId,prenom:e.prenom,nom:e.nom,email:e.email,bio:e.bio,adresse:e.adresse,phone:e.phone,dateNaissance:new Date(e.dob).getTime(),interetIds:e.interets.map(i=>Number(i))};this.userService.updateProfile(t).subscribe({next:i=>{this.presentSuccessToast("Profil mis \xE0 jour avec succ\xE8s")},error:i=>{console.error("Erreur lors de la mise \xE0 jour du profil",i)}})}else console.warn("Le formulaire est invalide")}goBack(){this.location.back()}presentSuccessToast(e){return v(this,null,function*(){yield(yield this.toastController.create({message:e,duration:3e3,color:"success",position:"bottom"})).present()})}onFileSelected(e){let t=e.target.files[0];if(t){let i=new FileReader;i.onload=()=>{this.profileImagePreview=i.result},i.readAsDataURL(t),this.editProfileForm.patchValue({profileImage:t})}}loadInterets(){this.interetService.getAllInterets().subscribe({next:e=>{this.interets=e},error:e=>{console.error("Erreurs lors du chargement des int\xE9r\xEAts :",e)}})}loadUserInterets(){this.interetService.getCurrentUserInterets().subscribe({next:e=>{this.userInterets=e,this.editProfileForm.patchValue({interets:this.userInterets.map(t=>t.id)})},error:e=>{console.error("Erreur lors du chargement des int\xE9r\xEAts utilisateur :",e)}})}onCheckboxChange(e){let t=this.editProfileForm.get("interets")?.value||[];e.target.checked?this.editProfileForm.patchValue({interets:[...t,e.target.value]}):this.editProfileForm.patchValue({interets:t.filter(i=>i!==e.target.value)})}};s.\u0275fac=function(t){return new(t||s)(m(C),m(T),m($),m(A),m(q),m(B))},s.\u0275cmp=P({type:s,selectors:[["app-edit-profile"]],decls:49,vars:2,consts:[[1,"bg-white"],[1,"d-flex","align-items-center","justify-content-between","px-3","pt-4"],[1,"bi","bi-chevron-left","fs-4",3,"click"],[1,"flex-grow-1","text-center","mb-0","fw-bold"],[2,"width","24px"],[1,"d-flex","justify-content-center","align-items-center","mt-4","mb-3","position-relative"],[1,"profile-wrapper"],["src","assets/img/myLOve/profile/profile1.png","alt","Profil","id","profilePreview",1,"profile-picture"],["type","file","id","profileImageInput","accept","image/*",2,"display","none",3,"change"],["for","profileImageInput",1,"btn","btn-pink","p-1","rounded-circle","position-absolute",2,"bottom","0","right","calc(50% - 60px)","transform","translateX(50%)","cursor","pointer"],["src","assets/icon/vector-camera.png",1,"mr-7",2,"width","20px","height","20px"],[1,"px-3",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","nom",1,"form-label","fw-semibold"],["type","text","formControlName","nom","placeholder","Sow",1,"form-control"],["for","prenom",1,"form-label","fw-semibold"],["type","text","formControlName","prenom","placeholder","Ahmadou Bamba",1,"form-control"],["for","email",1,"form-label","fw-semibold"],["type","email","formControlName","email","placeholder","ahmadou@example.com",1,"form-control"],["for","phone",1,"form-label","fw-semibold"],["type","text","formControlName","phone","placeholder","+221 77 000 00 00",1,"form-control"],["for","adresse",1,"form-label","fw-semibold"],["type","text","formControlName","adresse","placeholder","123, Rue du D\xE9veloppement",1,"form-control"],["for","bio",1,"form-label","fw-semibold"],["formControlName","bio","rows","3","placeholder","Parlez-nous de vous...",1,"form-control"],[1,"form-label","fw-semibold"],[1,"input-group"],["type","date","formControlName","dob",1,"form-control"],[1,"input-group-text","bg-white","border-start-0"],[1,"bi","bi-calendar"],[1,"row"],["class","col-6",4,"ngFor","ngForOf"],[1,"mb-3","text-center"],[1,"btn","btn-sm","btnSave","px-4"],[1,"col-6"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"change","value","checked"],["for","",1,"form-check-label"]],template:function(t,i){t&1&&(o(0,"ion-content",0)(1,"div",1)(2,"i",2),f("click",function(){return i.goBack()}),r(),o(3,"h5",3),l(4,"Edit Profile"),r(),n(5,"div",4),r(),o(6,"div",5)(7,"div",6),n(8,"img",7),r(),o(9,"input",8),f("change",function(p){return i.onFileSelected(p)}),r(),o(10,"label",9),n(11,"img",10),r()(),o(12,"form",11),f("ngSubmit",function(){return i.onSubmit()}),o(13,"div",12)(14,"label",13),l(15,"Nom"),r(),n(16,"input",14),r(),o(17,"div",12)(18,"label",15),l(19,"Pr\xE9nom"),r(),n(20,"input",16),r(),o(21,"div",12)(22,"label",17),l(23,"Email"),r(),n(24,"input",18),r(),o(25,"div",12)(26,"label",19),l(27,"T\xE9l\xE9phone"),r(),n(28,"input",20),r(),o(29,"div",12)(30,"label",21),l(31,"Adresse"),r(),n(32,"input",22),r(),o(33,"div",12)(34,"label",23),l(35,"Bio"),r(),n(36,"textarea",24),r(),o(37,"div",12)(38,"label",25),l(39,"Date de naissance"),r(),o(40,"div",26),n(41,"input",27),o(42,"span",28),n(43,"i",29),r()()(),o(44,"div",30),E(45,L,5,3,"div",31),r(),o(46,"div",32)(47,"button",33),l(48,"Enregistrer"),r()()()()),t&2&&(u(12),b("formGroup",i.editProfileForm),u(33),b("ngForOf",i.interets))},dependencies:[U,F,I,V,M,y,k,N,j,O,D],styles:[".bi-chevron-left[_ngcontent-%COMP%]{font-weight:700}.input-group[_ngcontent-%COMP%]   select.form-select[_ngcontent-%COMP%]{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.input-group-text[_ngcontent-%COMP%]{border-left:none;background:#fff}ion-select.custom-select[_ngcontent-%COMP%]{--border-radius: 8px;--padding-start: 12px;--min-height: 46px;--border-color: #dee2e6;--background: #fff;--placeholder-color: #6c757d;font-size:.95rem;border:1px solid #ced4da}.profile-wrapper[_ngcontent-%COMP%]{display:inline-block;padding:2px;border:1px solid #ff008A;border-radius:50%;background-color:#fff;box-shadow:0 4px 8px #0000001a;// ombre douce}.profile-picture[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;border:1px solid #ff008A;// deuxi\\e8me bordure (interne) background-color: white}label[_ngcontent-%COMP%]{font-family:Inter}.btnSave[_ngcontent-%COMP%]{background-color:#ff008a;color:#fff;border:none;font-weight:600}"]});let d=s;return d})();export{ee as EditProfilePage};
