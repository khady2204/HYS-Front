import{a as $}from"./chunk-NH4GJBFC.js";import{e as E,f as T,g as P,h as V,l as M,m as O,n as F,p as j,r as z,s as A}from"./chunk-SKEETBT7.js";import{a as U}from"./chunk-NUWLO4TS.js";import{h as y}from"./chunk-RETT3Y54.js";import{Ac as k,Da as b,Ha as f,Va as d,W as g,Wa as r,X as p,Xa as s,Xb as S,cc as w,fb as I,gb as h,ib as _,qb as u,rb as v,sa as a,xa as m}from"./chunk-WVCMXTPH.js";import"./chunk-AAGPOIMH.js";import"./chunk-HFL6MWQG.js";import"./chunk-UJWRXINH.js";import"./chunk-4XRDT473.js";import"./chunk-OAZACCPN.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-HHPFJLTL.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as C}from"./chunk-JHI3MBHO.js";function D(o,i){if(o&1){let l=I();r(0,"ion-item")(1,"ion-label",8),u(2),s(),r(3,"ion-checkbox",9),h("ionChange",function(){let e=g(l).$implicit,n=_();return p(n.toggleSelection(e.id))}),s()()}if(o&2){let l=i.$implicit;a(2),v(l.nom)}}function L(o,i){if(o&1){let l=I();r(0,"ion-item")(1,"ion-label",8),u(2),s(),r(3,"ion-checkbox",9),h("ionChange",function(){let e=g(l).$implicit,n=_();return p(n.toggleSelection(e.id))}),s()()}if(o&2){let l=i.$implicit;a(2),v(l.nom)}}var W=(()=>{let i=class i{constructor(t,e,n,c){this.userAuthService=t,this.interetService=e,this.router=n,this.toastController=c,this.interets=[],this.selectedInterets=[],this.userId=null,this.leftColumn=[],this.rightColumn=[]}ngOnInit(){if(!localStorage.getItem("jwtToken")){console.warn("Utilisateur non authentifi\xE9."),this.router.navigate(["/login"]);return}let e=this.userAuthService.getId();this.userId=e?Number(e):null,this.interetService.getAllInterets().subscribe({next:n=>{this.interets=n.map(x=>({id:x.id,nom:x.nom}));let c=Math.ceil(this.interets.length/2);this.leftColumn=this.interets.slice(0,c),this.rightColumn=this.interets.slice(c),console.log(" Int\xE9r\xEAts charg\xE9s :",this.interets)},error:n=>{console.error(" Erreur lors du chargement des int\xE9r\xEAts :",n)}})}toggleSelection(t){this.selectedInterets.includes(t)?this.selectedInterets=this.selectedInterets.filter(e=>e!==t):this.selectedInterets.push(t)}envoyerChoix(){if(!this.userId){console.warn("Utilisateur non connect\xE9.");return}if(!this.selectedInterets||this.selectedInterets.length===0){this.showToast("Veuillez s\xE9lectionner au moins un centre d'int\xE9r\xEAt","danger");return}let t={userId:this.userId,interetIds:this.selectedInterets};console.log(" Payload envoy\xE9 :",t),this.interetService.createUserInteret(t).subscribe({next:()=>{this.showToast("Choix enregistr\xE9 avec succ\xE8s !","success"),this.router.navigate(["/suggestion"])},error:e=>{console.error(" Erreur lors de l'envoi des int\xE9r\xEAts :",e),this.showToast("Erreur lors de l'envoi des centres d'int\xE9r\xEAt. Veuillez r\xE9essayer.","danger")}})}showToast(t,e="danger"){return C(this,null,function*(){(yield this.toastController.create({message:t,duration:3e3,color:e})).present()})}};i.\u0275fac=function(e){return new(e||i)(m(U),m($),m(y),m(z))},i.\u0275cmp=b({type:i,selectors:[["app-interets"]],decls:15,vars:3,consts:[[1,"ion-padding",3,"fullscreen"],[1,"p-1"],[1,"ion-padding","text-center"],[1,"fs-5"],["size","6"],[4,"ngFor","ngForOf"],[1,"bouton-container"],[1,"btn-suivant",3,"click"],[1,"nameInteret"],["slot","end",3,"ionChange"]],template:function(e,n){e&1&&(r(0,"ion-content",0)(1,"div",1)(2,"ion-text",2)(3,"h2",3),u(4,"Veuillez choisir vos centres d'int\xE9r\xEAt"),s()()(),r(5,"ion-row")(6,"ion-col",4)(7,"ion-list"),f(8,D,4,1,"ion-item",5),s()(),r(9,"ion-col",4)(10,"ion-list"),f(11,L,4,1,"ion-item",5),s()()(),r(12,"div",6)(13,"ion-button",7),h("click",function(){return n.envoyerChoix()}),u(14,"Suivant"),s()()()),e&2&&(d("fullscreen",!0),a(8),d("ngForOf",n.leftColumn),a(3),d("ngForOf",n.rightColumn))},dependencies:[T,F,j,E,A,M,V,O,P,w,S,k],styles:[".nameInteret[_ngcontent-%COMP%]{background-color:#ff0084;color:#fff;padding:10px;margin:05px;border-radius:10px}.bouton-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.btn-suivant[_ngcontent-%COMP%]{margin-top:30px;font-size:1.1em;font-weight:300;min-width:170px;border-radius:6px;color:#000;background:#f4f4f4;--background: #f4f4f4;--color: #000000}"]});let o=i;return o})();export{W as InteretsPage};
