import{a as Z}from"./chunk-IWOS63WX.js";import{a as L,b as D,c as N,d as V,f as B,g as G,h as R,j as q,k as H,l as U}from"./chunk-YVFP7G2U.js";import"./chunk-POA22WFE.js";import"./chunk-QUJFQN2Y.js";import"./chunk-6D27DZ34.js";import"./chunk-3NODV7JW.js";import"./chunk-547OZNO4.js";import"./chunk-JX6BS7SJ.js";import"./chunk-3TIPS6QV.js";import"./chunk-BSAYALUA.js";import"./chunk-7FY2OE2O.js";import"./chunk-J2OL6VUA.js";import"./chunk-GSIDHORN.js";import"./chunk-ET25664Q.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-JWWC77AT.js";import"./chunk-CKP3SGE2.js";import"./chunk-5IOERQT4.js";import{a as A}from"./chunk-NUWLO4TS.js";import{h as M,i as y,m as P}from"./chunk-RETT3Y54.js";import{Ac as z,Bc as j,Da as v,Ha as h,Va as m,Wa as e,Xa as n,Ya as d,Yb as w,cc as _,gb as C,jc as S,lc as u,nc as k,oc as E,qb as r,rc as O,sa as p,sc as I,tc as T,xa as s,zc as F}from"./chunk-WVCMXTPH.js";import"./chunk-HFL6MWQG.js";import"./chunk-UJWRXINH.js";import"./chunk-4XRDT473.js";import"./chunk-OAZACCPN.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-HHPFJLTL.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as b}from"./chunk-JHI3MBHO.js";function $(l,a){l&1&&(e(0,"ion-text",22)(1,"small"),r(2,"Entrez un email ou un num\xE9ro de t\xE9l\xE9phone"),n()())}function J(l,a){l&1&&(e(0,"ion-text",22)(1,"small"),r(2,"Mot de passe requis (min 6 caract\xE8res)"),n()())}var ae=(()=>{let a=class a{constructor(i,t,o,f,c){this.fb=i,this.router=t,this.authService=o,this.toastController=f,this.userAuthService=c,this.loginForm=this.fb.group({identifier:["",[u.required,u.pattern(/^((\d{9,15})|([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}))$/)]],password:["",[u.required,u.minLength(6)]]})}get identifier(){return this.loginForm.get("identifier")}get password(){return this.loginForm.get("password")}showToast(i,t="success"){return b(this,null,function*(){(yield this.toastController.create({message:i,duration:3e3,color:t})).present()})}onLogin(){if(this.loginForm.invalid){this.showToast("Veuillez corriger les erreurs","danger");return}let i=this.loginForm.value.identifier,t=this.loginForm.value.password,o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i),f=/^\d{9,15}$/.test(i),c={password:t};if(o)c.email=i;else if(f)c.phone=i;else{this.showToast("Identifiant invalide","danger");return}this.authService.login(c).subscribe({next:g=>{if(this.showToast("Connexion r\xE9ussie !"),g.token){this.userAuthService.setToken(g.token);let x=this.decodeToken(g.token);this.userAuthService.setUser(x),console.log("Utilisateur connect\xE9:",x),x?.id!==void 0&&this.userAuthService.setId(String(x.id))}this.router.navigate(["/accueil"])},error:g=>{console.error("Erreur de connexion :",g),this.showToast("identifiant ou mot de passe incorrect","danger")}})}decodeToken(i){try{let t=i.split(".")[1];return JSON.parse(atob(t))}catch(t){return console.error("Erreur de d\xE9codage du token:",t),null}}};a.\u0275fac=function(t){return new(t||a)(s(F),s(M),s(Z),s(H),s(A))},a.\u0275cmp=v({type:a,selectors:[["app-login"]],decls:38,vars:4,consts:[["slot","start"],["defaultHref","/home"],["fullscreen","",1,"login-container"],[1,"login-wrapper"],[1,"logo-container"],["src","assets/logo.png",1,"logo-img"],[1,"login-title"],[1,"google-login"],["expand","block","fill","outline",1,"google-btn"],["src","assets/google-icon.png","slot","start",1,"google-icon"],[1,"text"],[3,"ngSubmit","formGroup"],[1,"input-container"],[1,"input-label"],["type","text","formControlName","identifier","placeholder","Entrer email ou t\xE9l\xE9phone",1,"native-input"],["color","danger",4,"ngIf"],["type","password","formControlName","password","placeholder","Entrer mot de passe",1,"native-input"],[1,"bp-container"],["routerLink","/f-password",1,"forgot-link"],["expand","block","type","submit",1,"login-button",3,"disabled"],[1,"secondary-actions"],["routerLink","/register",1,"login-link"],["color","danger"]],template:function(t,o){t&1&&(e(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d(3,"ion-back-button",1),n()()(),e(4,"ion-content",2)(5,"div",3)(6,"div",4),d(7,"img",5),n(),e(8,"h2",6),r(9,"Connexion"),n(),e(10,"div",7)(11,"ion-button",8),d(12,"img",9)(13,"img"),e(14,"ion-text",10),r(15,"Se connecter avec Google"),n()()(),e(16,"form",11),C("ngSubmit",function(){return o.onLogin()}),e(17,"div",12)(18,"label",13),r(19,"Email ou T\xE9l\xE9phone"),n(),d(20,"input",14),n(),h(21,$,3,0,"ion-text",15),e(22,"div",12)(23,"label",13),r(24,"Mot de passe"),n(),d(25,"input",16),n(),h(26,J,3,0,"ion-text",15),e(27,"div",17)(28,"a",18),r(29,"Mot de passe oubli\xE9 ?"),n()(),e(30,"ion-button",19),r(31," Se connecter "),n()(),e(32,"div",20)(33,"ion-text")(34,"p"),r(35,"Vous n'avez pas de compte ? "),e(36,"a",21),r(37,"S'inscrire"),n()()()()()()),t&2&&(p(16),m("formGroup",o.loginForm),p(5),m("ngIf",o.identifier.invalid&&o.identifier.touched),p(5),m("ngIf",o.password.invalid&&o.password.touched),p(4),m("disabled",o.loginForm.invalid))},dependencies:[U,L,D,N,V,B,G,R,q,z,O,S,k,E,j,I,T,P,y,_,w],styles:["ion-toolbar[_ngcontent-%COMP%]{--border-width: 0;box-shadow:none;height:100px;--min-height: 56px;margin:0 auto;width:100%;padding:0 16px;border-top-left-radius:20px;border-top-right-radius:20px}ion-back-button[_ngcontent-%COMP%]{margin-left:-20px;margin-top:40px;color:#0d3873}.login-container[_ngcontent-%COMP%]{--background: #f6f6fb;display:flex;justify-content:center;align-items:center;height:100%}.login-wrapper[_ngcontent-%COMP%]{background:#fff;border-radius:0 0 20px 20px;padding:24px;width:100%;box-shadow:0 8px 24px #0000001a;display:flex;flex-direction:column;align-items:stretch;justify-content:center;margin:auto;height:100%}.logo-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:3px}.logo-img[_ngcontent-%COMP%]{width:150px;height:auto;margin:0 auto}.login-title[_ngcontent-%COMP%]{text-align:center;font-size:1.4rem;font-weight:700;margin-top:5px;margin-bottom:20px;color:#0d3873}.google-login[_ngcontent-%COMP%]{margin-top:2px;text-align:center;display:flex}.text[_ngcontent-%COMP%]{color:#f1f1f1;text-transform:none}.google-btn[_ngcontent-%COMP%]{--border-color: #0D3873;--background: #0D3873;border-radius:8px;height:20px;width:100%;margin:15px 5px;justify-content:space-between;display:flex;align-items:center;padding:0}.google-icon[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.input-label[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin-bottom:4px;color:#000;display:block;padding-left:4px}.input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px;width:100%}.half-input[_ngcontent-%COMP%]{flex:1;--background: #f1f1f1;--padding-start: 10px;--border-radius: 10px}ion-input[_ngcontent-%COMP%]{--background: #f1f1f1;--padding-start: 10px;--border-radius: 10px}.native-input[_ngcontent-%COMP%]{width:100%;border:none;outline:none;font-size:16px;padding:12px 10px;border-radius:10px;background:#f1f1f1;box-sizing:border-box}.native-input[_ngcontent-%COMP%]:focus{border:1px solid #0D3873}ion-text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{padding-left:12px;font-size:.85rem}ion-button.login-button[_ngcontent-%COMP%]{--background: #0D3873;--color: white;text-transform:none;margin-bottom:15px}.login-link[_ngcontent-%COMP%]{color:#0d3873}.secondary-actions[_ngcontent-%COMP%]{text-align:center;margin-top:5px;font-style:italic}.bp-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;max-width:300px;margin-bottom:20px}.terms[_ngcontent-%COMP%]{--background: transparent;margin:0;padding:0;--inner-padding-end: 0;--inner-padding-start: 0;--padding-start: 0;--min-height: 40px}ion-checkbox.term[_ngcontent-%COMP%]{box-shadow:0 4px 4px #0f0f0f4d;color:#0d3873}.password-item[_ngcontent-%COMP%]{flex:1;margin-right:8px}.forgot-link[_ngcontent-%COMP%]{color:#0d3873;font-size:.85rem;text-decoration:none;white-space:nowrap}"]});let l=a;return l})();export{ae as LoginPage};
